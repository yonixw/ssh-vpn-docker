version: '3'
services:
  vpn:
    build: .
    tty: true
    sysctls:
        - "net.ipv6.conf.all.disable_ipv6=0"
    cap_add:
        - NET_ADMIN 
    devices:
        - /dev/net/tun
    environment: 
      - "WAIT_VPN=5"
      - "SSH_ARGS=-i vm_ssh.pem ubuntu@10.0.1.119"
    volumes:
      - ./vpn_config.ovpn:/vpn/config/vpn_config.ovpn # OpenVPN config
      - ./vpn_client.key:/vpn/config/vpn_client.key   # OpenVPN private key (if apply)
      - ./vpn_client.crt:/vpn/config/vpn_client.crt   # OpenVPN private cert (if apply)
      - ./vm_ssh.pem:/vpn/config/vm_ssh.pem           # SSH Private key (if in SSH_ARGS above)